<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Variance Components testing for Linear and Nonlinear Mixed Effects Models • varTestnlme</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Variance Components testing for Linear and Nonlinear Mixed Effects Models">
<meta property="og:description" content="An implementation of the Likelihood ratio Test (LRT) for testing that,
    in a (non)linear mixed effects model, the variances of a subset of the random
    effects are equal to zero. There is no restriction on the subset of variances
    that can be tested: for example, it is possible to test that all the variances
    are equal to zero. Note that the implemented test is asymptotic.
    This package should be used on model fits from packages nlme, lmer, and saemix.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">varTestnlme</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="articles/varTestnlme.html">
    <span class="fa fa-play-circle"></span>
     
    Get started
  </a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/baeyc/varTestnlme">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="vartestnlme" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#vartestnlme" class="anchor"></a>varTestnlme</h1></div>
<p><a href="https://baeyc.github.io/varTestnlme/index.html">varTestnlme</a> implements the likelihood ratio test (LRT) for testing the presence of random effects in linear, generalized linear and nonlinear mixed-effects model. The test can be used to answer questions of the type:</p>
<ul>
<li>should a certain subset of random effects be in fact considered as fixed effects?</li>
<li>is there any random effects in the model?</li>
<li>are there any correlation between two subsets of random effects?</li>
</ul>
<p>It is possible to compare two models with different random effects, provided that the random structures of the two models are <strong>nested</strong>.</p>
<p>The package works on models that were fitted using <a href="https://cran.r-project.org/web/packages/nlme/">nlme</a>, <a href="https://cran.r-project.org/web/packages/lme4/">lme4</a>, or <a href="https://cran.r-project.org/web/packages/saemix/">saemix</a> packages.</p>
<div id="reference" class="section level2">
<h2 class="hasAnchor">
<a href="#reference" class="anchor"></a>Reference</h2>
<p>Baey C, Cournède P-H, Kuhn E, 2019. Asymptotic distribution of likelihood ratio test statistics for variance components in nonlinear mixed effects models. 135:107–122 (2019), <a href="https://doi.org/10.1016/j.csda.2019.01.014" class="uri">https://doi.org/10.1016/j.csda.2019.01.014</a></p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the development version from Github:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"baeyc/varTestnlme"</span>)</a></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># First, fit models from your preferred mixed-effects models package</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(nlme)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">fm1Indom.lis &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/nlme/man/nlsList.html">nlsList</a></span>(conc <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/SSbiexp.html">SSbiexp</a></span>(time, A1, lrc1, A2, lrc2),<span class="dt">data =</span> Indometh)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">m1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/nlme/man/nlme.html">nlme</a></span>(fm1Indom.lis,<span class="dt">random =</span> <span class="kw"><a href="https://rdrr.io/pkg/nlme/man/pdDiag.html">pdDiag</a></span>(A1 <span class="op">+</span><span class="st"> </span>lrc1 <span class="op">+</span><span class="st"> </span>A2 <span class="op">+</span><span class="st"> </span>lrc2 <span class="op">~</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">m0 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/nlme/man/nlme.html">nlme</a></span>(fm1Indom.lis,<span class="dt">random =</span> <span class="kw"><a href="https://rdrr.io/pkg/nlme/man/pdDiag.html">pdDiag</a></span>(A1 <span class="op">+</span><span class="st"> </span>lrc1 <span class="op">~</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co"># Then, simply use the varTest function to compare the two models</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co"># It will automatically detect the covariance structures</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="kw">varTest</span>(m1,m0)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; Variance components testing in mixed-effects models</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; (models fitted using the nlme package)</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; Testing that the variances of A2 and lrc2 are null</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; model under H1: list(A1 ~ 1, lrc1 ~ 1, A2 ~ 1, lrc2 ~ 1) (fixed effects) , structure(list(Subject = structure(c(3.43637993576256, 2.44739674232125, 2.05693983560385, 1.96340665027553), formula = structure(list(A1 ~ 1, lrc1 ~ 1, A2 ~ 1, lrc2 ~ 1), class = "listForm"), Dimnames = list(c("A1", "lrc1", "A2", "lrc2"), c("A1", "lrc1", "A2", "lrc2")), class = c("pdDiag", "pdMat"))), settings = c(0, 1, 0, 1), class = "reStruct") (random effects)</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; model under H0: list(A1 ~ 1, lrc1 ~ 1, A2 ~ 1, lrc2 ~ 1) (fixed effects) , structure(list(Subject = structure(c(3.43637993576256, 2.44739674232125), formula = structure(list(A1 ~ 1, lrc1 ~ 1), class = "listForm"), Dimnames = list(c("A1", "lrc1"), c("A1", "lrc1")), class = c("pdDiag", "pdMat"))), settings = c(0, 1, 0, 1), class = "reStruct") (random effects)</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; Likelihood ratio test statistics: </span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt;  LRT =  4.5608 </span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; Limiting distribution: </span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt; mixture of 3 chi-bar-square distributions with degrees of freedom 0, 1, 2 </span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; lower-bound for p-value: 0.016356  upper bound for p-value: 0.067476</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/baeyc/varTestnlme">https://​github.com/​baeyc/​varTestnlme</a>
</li>
<li>Report a bug at <br><a href="http://github.com/baeyc/varTestnlme/issues%20%20">http://​github.com/​baeyc/​varTestnlme/​issues  </a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing varTestnlme</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://math.univ-lille1.fr/~baey/">Charlotte Baey</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1413-1058" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
<li>Estelle Kuhn <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://math.univ-lille1.fr/~baey/">Charlotte Baey</a>, Estelle Kuhn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
