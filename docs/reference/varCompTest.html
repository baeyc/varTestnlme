<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Variance component testing — varCompTest • varTestnlme</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Variance component testing — varCompTest"><meta property="og:description" content="Perform a likelihood ratio test to test whether a subset of the variances of the random effects
are equal to zero. The test is defined by two hypotheses, H0 and H1, and the model under H0 is
assumed to be nested within the model under H1. These functions can be used on objects of class
lme-, nlme-, mer-, lmerMod, glmerMod, nlmerMord or SaemixObject.
It is possible to tests if any subset of the variances are equal to zero. However, the function does not
currently support nested random effects, and assumes that the random effects are Gaussian."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">varTestnlme</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/varTestnlme.html">
    <span class="fa fa-play-circle"></span>
     
    Get started
  </a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/baeyc/varTestnlme" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Variance component testing</h1>
    <small class="dont-index">Source: <a href="https://github.com/baeyc/varTestnlme/blob/HEAD/R/generics.R" class="external-link"><code>R/generics.R</code></a>, <a href="https://github.com/baeyc/varTestnlme/blob/HEAD/R/varCompTest.lme.R" class="external-link"><code>R/varCompTest.lme.R</code></a>, <a href="https://github.com/baeyc/varTestnlme/blob/HEAD/R/varCompTest.merMod.R" class="external-link"><code>R/varCompTest.merMod.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>varCompTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform a likelihood ratio test to test whether a subset of the variances of the random effects
are equal to zero. The test is defined by two hypotheses, H0 and H1, and the model under H0 is
assumed to be nested within the model under H1. These functions can be used on objects of class
<code>lme</code>-, <code>nlme</code>-, <code>mer</code>-, <code>lmerMod</code>, <code>glmerMod</code>, <code>nlmerMord</code> or <code>SaemixObject</code>.</p>
<p>It is possible to tests if any subset of the variances are equal to zero. However, the function does not
currently support nested random effects, and assumes that the random effects are Gaussian.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">varCompTest</span><span class="op">(</span></span>
<span>  <span class="va">m1</span>,</span>
<span>  <span class="va">m0</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>M <span class="op">=</span> <span class="fl">5000</span>, parallel <span class="op">=</span> <span class="cn">T</span>, nb_cores <span class="op">=</span> <span class="fl">1</span>, B <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  pval.comp <span class="op">=</span> <span class="st">"bounds"</span>,</span>
<span>  fim <span class="op">=</span> <span class="st">"extract"</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for lme</span></span>
<span><span class="fu">varCompTest</span><span class="op">(</span></span>
<span>  <span class="va">m1</span>,</span>
<span>  <span class="va">m0</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>M <span class="op">=</span> <span class="fl">5000</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span>, nb_cores <span class="op">=</span> <span class="fl">1</span>, B <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  pval.comp <span class="op">=</span> <span class="st">"bounds"</span>,</span>
<span>  fim <span class="op">=</span> <span class="st">"extract"</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for merMod</span></span>
<span><span class="fu">varCompTest</span><span class="op">(</span></span>
<span>  <span class="va">m1</span>,</span>
<span>  <span class="va">m0</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>M <span class="op">=</span> <span class="fl">5000</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span>, nb_cores <span class="op">=</span> <span class="fl">1</span>, B <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  pval.comp <span class="op">=</span> <span class="st">"bounds"</span>,</span>
<span>  fim <span class="op">=</span> <span class="st">"extract"</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for SaemixObject</span></span>
<span><span class="fu">varCompTest</span><span class="op">(</span></span>
<span>  <span class="va">m1</span>,</span>
<span>  <span class="va">m0</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>M <span class="op">=</span> <span class="fl">5000</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span>, nb_cores <span class="op">=</span> <span class="fl">1</span>, B <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  pval.comp <span class="op">=</span> <span class="st">"bounds"</span>,</span>
<span>  fim <span class="op">=</span> <span class="st">"extract"</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>m1</dt>
<dd><p>a fit of the model under H1, obtained from <code>nlme</code>, <code>lme4</code>
or <code>saemix</code></p></dd>


<dt>m0</dt>
<dd><p>a fit of the model under H0, obtained from the same package as <code>m0</code></p></dd>


<dt>control</dt>
<dd><p>(optional) a list of control options for the computation of the chi-bar-weights (see Details section)</p></dd>


<dt>pval.comp</dt>
<dd><p>(optional) the method to be used to compute the p-value, one of: <code>"bounds"</code> (the default),
<code>"approx"</code> or <code>"both"</code> (see Details section)</p></dd>


<dt>fim</dt>
<dd><p>(optional) the method to compute the Fisher Information Matrix. Options are: <code>fim="extract"</code> to extract the
FIM computed by the package which was used to fit the models, <code>fim="compute"</code> to evaluate the FIM using parametric
bootstrap, and <code>fim=I</code> with <code>I</code> a positive semidefinite matrix, for a FIM provided by the user.</p></dd>


<dt>output</dt>
<dd><p>a boolean specifying if any output should be printed in the console (default to TRUE)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>htest</code> with the following components:</p><ul><li><p><code>statistic</code> the likelihood ratio test statistics</p></li>
<li><p><code>null.value</code></p></li>
<li><p><code>alternative</code></p></li>
<li><p><code>parameters</code> the parameters of the limiting chi-bar-square distribution: the degrees of freedom and
the weights of the chi-bar-square components and the Fisher Information Matrix</p></li>
<li><p><code>method</code> a character string indicating the name of the test</p></li>
<li><p><code>pvalue</code> a named vector containing the different p-values computed by the function: using the 
(estimated) weights, using the random sample from the chi-bar-square distribution, and the two bounds on
the p-value.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The asymptotic distribution of the likelihood ratio test is a chi-bar-square, with weights that need to be
approximated by Monte Carlo methods, apart from some specific cases where they are available explicitly. 
Therefore, the p-value of the test is not exact but approximated. This computation can be time-consuming, so
the default behaviour of the function is to provide bounds on the exact p-value, which can be enough in practice
to decide whether to reject or not the null hypothesis. This is triggered by the option <code>pval.comp="bounds"</code>.
To compute an approximation of the exact p-value, one should use the option <code>pval.comp="approx"</code> or <code>pval.comp="both"</code>.</p>
<p>When <code>pval.comp="approx"</code> or <code>pval.comp="both"</code>, the weights of the chi-bar-square distribution are computed using Monte Carlo,
which might involve a larger computing time.</p>
<p>The <code>control</code> argument controls the options for chi-bar-square weights computation. It is a list with the
following elements: <code>M</code> the size of the Monte Carlo simulation, i.e. the number of samples generated, <code>parallel</code> a
boolean to specify if parallel computing should be used, and <code>nbcores</code> the number of cores to be used in case of 
parallel computing. Default is <code>M=5000</code>, <code>parallel=FALSE</code> and <code>nb_cores=1</code>.
If <code>parallel=TRUE</code> but the value of <code>nb_cores</code> is not given, then it is set to the number of detected
cores minus 1</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Baey C, Cournède P-H, Kuhn E, 2019. Asymptotic distribution of likelihood ratio test
statistics for variance components in nonlinear mixed effects models. <em>Computational
Statistics and Data Analysis</em> 135:107-122.</p>
<p>Silvapulle  MJ, Sen PK, 2011. Constrained statistical inference: order, inequality and shape constraints.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Charlotte Baey &lt;<a href="mailto:charlotte.baey@univ-lille.fr">charlotte.baey@univ-lille.fr</a>&gt;</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># load lme4 package and example dataset</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Matrix</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Orthodont</span>, package <span class="op">=</span> <span class="st">"nlme"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit the two models under H1 and H0</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">distance</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">age</span><span class="op">*</span><span class="va">Sex</span> <span class="op">+</span> </span></span>
<span class="r-in"><span><span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">age</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Orthodont</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">distance</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">age</span><span class="op">*</span><span class="va">Sex</span>, data <span class="op">=</span> <span class="va">Orthodont</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare them (order is important: m1 comes first)</span></span></span>
<span class="r-in"><span><span class="fu">varCompTest</span><span class="op">(</span><span class="va">m1</span>,<span class="va">m0</span>,pval.comp<span class="op">=</span><span class="st">"bounds"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Variance components testing in mixed effects models</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Testing that the variance of the random effect associated to age is equal to 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Likelihood ratio test statistic:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	LRT = 46.58827</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> p-value from exact weights: 4.379151e-12</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using nlme</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘nlme’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:lme4’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lmList</span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">distance</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">age</span><span class="op">*</span><span class="va">Sex</span>, </span></span>
<span class="r-in"><span>random <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/pdSymm.html" class="external-link">pdSymm</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">age</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Orthodont</span>, method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">distance</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">Sex</span>, random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">Subject</span>, data <span class="op">=</span> <span class="va">Orthodont</span>, method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">varCompTest</span><span class="op">(</span><span class="va">m1</span>,<span class="va">m0</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Variance components testing in mixed effects models</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Testing that the means of the random effects associated to age and SexFemale:age are equal to 0 and that</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  the variance of the random effect associated to age is equal to 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Likelihood ratio test statistic:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	LRT = 79.15214</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> p-value from exact weights: 1.550226e-16</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://baeyc.github.io/" class="external-link">Charlotte Baey</a>, Estelle Kuhn.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

