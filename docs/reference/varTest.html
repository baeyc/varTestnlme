<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Variance component testing — varTest • varTestnlme</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Variance component testing — varTest" />
<meta property="og:description" content="Perform a likelihood ratio test to test whether a subset of the variances of the random effects
are equal to zero. The test is defined by two hypotheses, H0 and H1, and the model under H0 is
assumed to be nested within the model under H1." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">varTestnlme</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/varTestnlme.html">
    <span class="fa fa-play-circle"></span>
     
    Get started
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/baeyc/varTestnlme">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Variance component testing</h1>
    <small class="dont-index">Source: <a href='http://github.com/baeyc/varTestnlme/blob/master/R/varTest.R'><code>R/varTest.R</code></a></small>
    <div class="hidden name"><code>varTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform a likelihood ratio test to test whether a subset of the variances of the random effects
are equal to zero. The test is defined by two hypotheses, H0 and H1, and the model under H0 is
assumed to be nested within the model under H1.</p>
    </div>

    <pre class="usage"><span class='fu'>varTest</span>(
  <span class='no'>m1</span>,
  <span class='no'>m0</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>M</span> <span class='kw'>=</span> <span class='fl'>5000</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>nbcores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>1000</span>),
  <span class='kw'>pval.comp</span> <span class='kw'>=</span> <span class='st'>"bounds"</span>,
  <span class='kw'>fim</span> <span class='kw'>=</span> <span class='st'>"extract"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>m1</th>
      <td><p>a fit of the model under H1, obtained from <code><a href='https://rdrr.io/pkg/nlme/man/nlme.html'>nlme</a></code>, <code><a href='https://rdrr.io/pkg/lme4/man/lme4-package.html'>lme4</a></code>
or <code><a href='https://rdrr.io/pkg/saemix/man/saemix.html'>saemix</a></code></p></td>
    </tr>
    <tr>
      <th>m0</th>
      <td><p>a fit of the model under H0, obtained from the same package as <code>m0</code></p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>(optional) a list of control options for the computation of the chi-bar-weights</p></td>
    </tr>
    <tr>
      <th>pval.comp</th>
      <td><p>(optional) the method to be used to compute the p-value, one of: <code>"bounds"</code> (the default),
<code>"approx"</code> or <code>"both"</code> (see Details section)</p></td>
    </tr>
    <tr>
      <th>fim</th>
      <td><p>(optional) the method to compute the Fisher Information Matrix. Currently, only <code>fim="extract"</code> is supported.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following components:</p>
<dt><code>lrt</code></dt><dd><p>the likelihood ratio test statistics</p></dd>
<dt><code>ddl</code></dt><dd><p>the degrees of freedom of the chi-bar distributions involved in the chi-bar-square distribution</p></dd>
<dt><code>weights</code></dt><dd><p>the weights of the limiting chi-bar-square distribution</p></dd>
<dt><code>pval</code></dt><dd><p>the p-value of the test</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>It is possible to tests if any subset of the variances are equal to zero. However, the function does not
currently support nested random effects, and assumes that the random effects are Gaussian.</p>
<p>The asymptotic distribution of the likelihood ratio test is a chi-bar-square, with weights that need to be
approximated by Monte Carlo methods, apart from some specific cases where they are available explicitly. 
Therefore, the p-value of the test is not exact but approximated. This computation can be time-consuming, so
the default behaviour of the function is to provide bounds on the exact p-value, which can be enough in practice
to decide whether to reject or not the null hypothesis. This is triggered by the option <code>pval.comp="bounds"</code>.
To compute an approximation of the exact p-value, one should use the option <code>pval.comp="approx"</code> or <code>pval.comp="both"</code>.</p>
<p>The <code>control</code> argument controls the options for chi-bar-square weights computation. It is a list with the
following elements: <code>M</code> the size of the Monte Carlo simulation, <code>parallel</code> a boolean for parallel computing
and <code>nbcores</code> the number of cores to be used in case of parallel computing. Default is <code>M=5000</code>, <code>parallel=FALSE</code>
and <code>nbcores=1</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Baey C, Cournède P-H, Kuhn E, 2019. Asymptotic distribution of likelihood ratio test
statistics for variance components in nonlinear mixed effects models. <em>Computational
Statistics and Data Analysis</em> 135:107-122.</p>
<p>Silvapulle  MJ, Sen PK, 2011. Constrained statistical inference: order, inequality and shape constraints.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Charlotte Baey &lt;<a href='mailto:charlotte.baey@univ-lille.fr'>charlotte.baey@univ-lille.fr</a>&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># load nlme package and example dataset</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>nlme</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>Orthodont</span>)

<span class='co'># fit the two models under H1 and H0</span>
<span class='no'>lm1.h1.nlme</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/nlme/man/lme.html'>lme</a></span>(<span class='no'>distance</span> ~ <span class='fl'>1</span> + <span class='no'>Sex</span> + <span class='no'>age</span> + <span class='no'>age</span>*<span class='no'>Sex</span>, <span class='kw'>random</span> <span class='kw'>=</span> ~ <span class='fl'>1</span> + <span class='no'>age</span> <span class='kw'>|</span> <span class='no'>Subject</span>,
<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>Orthodont</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"ML"</span>)
<span class='no'>lm1.h0.nlme</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/nlme/man/lme.html'>lme</a></span>(<span class='no'>distance</span> ~ <span class='fl'>1</span> + <span class='no'>Sex</span> + <span class='no'>age</span> + <span class='no'>age</span>*<span class='no'>Sex</span>, <span class='kw'>random</span> <span class='kw'>=</span> ~ <span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>Subject</span>,
<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>Orthodont</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"ML"</span>)

<span class='co'># compare them (order is important: m1 comes first)</span>
<span class='fu'>varTest</span>(<span class='no'>lm1.h1.nlme</span>,<span class='no'>lm1.h0.nlme</span>)</div><div class='output co'>#&gt; <span class='message'>Variance components testing in mixed-effects models</span></div><div class='output co'>#&gt; <span class='message'>(models fitted using the nlme package)</span></div><div class='output co'>#&gt; <span class='message'>Testing that the variance of age is null</span></div><div class='output co'>#&gt; <span class='message'>model under H1: distance ~ 1 + Sex + age + age * Sex  (fixed effects),  ~1 + age | Subject  (random effects)</span></div><div class='output co'>#&gt; <span class='message'>model under H0: distance ~ 1 + Sex + age + age * Sex  (fixed effects),  ~1 | Subject  (random effects)</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Likelihood ratio test statistics: </span>
#&gt; <span class='message'> LRT =  0.83311 </span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Limiting distribution:</span></div><div class='output co'>#&gt; <span class='message'>mixture of 2 chi-bar-square distributions with degrees of freedom 1, 2 </span></div><div class='output co'>#&gt; <span class='message'>lower-bound for p-value: 0.51035  upper bound for p-value: 0.51035</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://math.univ-lille1.fr/~baey/'>Charlotte Baey</a>, Estelle Kuhn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


